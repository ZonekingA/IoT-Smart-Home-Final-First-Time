‡∏µupdate ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏¥‡∏î‡πÑ‡∏ü

#include <WiFi.h>
#include <HTTPClient.h>
#include <ArduinoJson.h>

// ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ WiFi
const char* ssid = "your_wifi_name";
const char* password = "your_wifi_password";

// ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API Endpoint ‡∏Ç‡∏≠‡∏á Node.js
const char* serverUrl = "http://your-server-ip:5000/api/update-device";

void setup() {
  Serial.begin(115200);
  WiFi.begin(ssid, password);

  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("\nConnected to WiFi");
}

void loop() {
  if (WiFi.status() == WL_CONNECTED) {
    HTTPClient http;
    http.begin(serverUrl);
    http.addHeader("Content-Type", "application/json");

    // üîπ ‡∏™‡∏£‡πâ‡∏≤‡∏á JSON Payload
    StaticJsonDocument<200> jsonDoc;
    JsonArray devices = jsonDoc.createNestedArray("devices");

    JsonObject device1 = devices.createNestedObject();
    device1["device_code"] = "A1b2C";
    device1["device_status"] = digitalRead(5); // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Pin 5

    JsonObject device2 = devices.createNestedObject();
    device2["device_code"] = "ywobM";
    device2["device_status"] = digitalRead(18); // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Pin 18

    // ‡πÅ‡∏õ‡∏•‡∏á JSON ‡πÄ‡∏õ‡πá‡∏ô String
    String jsonData;
    serializeJson(jsonDoc, jsonData);

    // üîπ ‡∏™‡πà‡∏á HTTP POST Request
    int httpResponseCode = http.POST(jsonData);
    Serial.print("Response Code: ");
    Serial.println(httpResponseCode);

    http.end();
  }

  delay(5000); // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
}
